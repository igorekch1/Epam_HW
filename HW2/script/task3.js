let products = [
    {
        name: "Motorola MOTO G4 (XT1622) Black",
        ratingRevievs: "264 отзыва", 
        price: {
            oldUan: "4 333 грн", 
            newUan: "3 799 грн"
        }
    }, {
        name: "Samsung Galaxy J7 J700H/DS Black + карта памяти 16гб + чехол + защитное стекло!",
        ratingRevievs: "1355 отзывов", 
        price: "4 999 грн"
    }, {
        name: "Samsung Galaxy J5 (2016) J510H/DS Black + защитное стекло + чехол!",
        ratingRevievs: "426 отзывов", 
        price: "5 199 грн"
    }, {
        name: "Xiaomi Redmi Note 4X 3/32GB Black",
        ratingRevievs: "403 отзыва", 
        price: "4 349 грн"
    }, {
        name: "Samsung Galaxy J7 (2016) J710F/DS Gold + защитное стекло + чехол!",
        ratingRevievs: "488 отзывов", 
        price: "6 199 грн"
    }, {
        name: "Lenovo K5 (A6020a40) Silver",
        ratingRevievs: "198 отзывов", 
        price: {
            oldUan: "3 495 грн", 
            newUan: "2 995 грн"
        }
    }, {
        name: "Apple iPhone 5s 16GB Space Gray",
        ratingRevievs: "352 отзыва", 
        price: {
            oldUan: "9 799 грн", 
            newUan: "7 999 грн"
        }
    }, {
        name: "Nokia 5 Dual Sim Tempered Blue",
        ratingRevievs: "59 отзывов", 
        price: "5 999 грн"
    }, {
        name: "Samsung Galaxy A5 2017 Duos SM-A520 Black + карта памяти 128гб!",
        ratingRevievs: "119 отзывов", 
        price: "11 999 грн"
    }, {
        name: "Samsung Galaxy J5 J500H/DS Black + чехол + защитное стекло!",
        ratingRevievs: "1106 отзывов", 
        price: "3 999 грн"
    }, {
        name: "Huawei Y3 II Tiffany (White-Blue) + чехол + защитное стекло!",
        ratingRevievs: "380 отзывов", 
        price: "2 199 грн"
    }, {
        name: "Samsung Galaxy S8 64GB Midnight Black + карта памяти 64гб + оригинальный чехол!",
        ratingRevievs: "86 отзывов", 
        price: {
            oldUan: "24 999 грн", 
            newUan: "22 999 грн"
        }
    }, {
        name: "Huawei P8 Lite 2017 White + УМБ Huawei AP08Q + защитное стекло + чехол!",
        ratingRevievs: "177 отзывов", 
        price: "6 499 грн"
    }, {
        name: "Xiaomi Redmi 4X 3/32GB Black (Международная версия)",
        ratingRevievs: "347 отзывов", 
        price: "4 299 грн"
    }, {
        name: "Samsung Galaxy J1 2016 SM-J120H Black + защитное стекло + чехол!",
        ratingRevievs: "709 отзывов", 
        price: "2 799 грн"
    }, {
        name: "Huawei Y6 Pro Gold + чехол + защитное стекло!",
        ratingRevievs: "527 отзывов", 
        price: "3 999 грн"
    }, {
        name: "Apple iPhone 6s 32GB Gold",
        ratingRevievs: "66 отзывов", 
        price: "16 499 грн"
    }, {
        name: "Apple iPhone 6 32GB Space Gray",
        ratingRevievs: "14 отзывов", 
        price: "11 499 грн", 
    }, {
        name: "Asus ZenFone 2 32GB (ZE551ML) Black",
        ratingRevievs: "70 отзывов", 
        price: {
            oldUan: "7 399 грн", 
            newUan: "5 999 грн"
        }
    }, {
        name: "Nokia 3 Dual Sim Silver White + сертификаты 500 грн!",
        ratingRevievs: "45 отзывов", 
        price: "4 299 грн"
    }, {
        name: "Meizu M3 Note 32GB Grey (Международная версия)",
        ratingRevievs: "376 отзывов", 
        price: "3 899 грн"
    }, {
        name: "Sony Xperia X Dual (F5122) White",
        ratingRevievs: "111 отзывов", 
        price: {
            oldUan: "9 999 грн",
            newUan: "7 999 грн"
        }
    }, {
        name: "Lenovo Vibe C (A2020) Black + УМБ PowerPlant 5200 mAh в подарок!",
        ratingRevievs: "40 отзывов", 
        price: "2 222 грн"
    }, {
        name: "Apple iPhone 7 32GB Black",
        ratingRevievs: "93 отзыва", 
        price: "18 999 грн"
    }, {
        name: "Huawei P10 4/32GB Black + сертификат 2500грн + чехол Huawei Smart View Cover!",
        ratingRevievs: "33 отзыва", 
        price: "16 999 грн"
    }, {
        name: "LG K5 X220ds Gold",
        ratingRevievs: "71 отзыв", 
        price: {
            oldUan: "2 399 грн", 
            newUan: "1 999 грн"
        }
    }, {
        name: "Lenovo C2 Power (K10a40) Black",
        ratingRevievs: "39 отзывов", 
        price: "2 995 грн"
    }, {
        name: "Nous NS 5006 Gold",
        ratingRevievs: "156 отзывов", 
        price: "2 599 грн"
    }, {
        name: "LG G6 Mystic White",
        ratingRevievs: "40 отзывов", 
        price: "19 689 грн"
    }, {
        name: "Motorola MOTO G5 (XT1676) Grey",
        ratingRevievs: "24 отзыва", 
        price: "5 995 грн"
    }, {
        name: "HTC One X10 Dual Sim Silver",
        ratingRevievs: "7 отзывов", 
        price: {
            oldUan: "10 999 грн", 
            newUan: "9 999 грн"
        }
    }, {
        name: "Sony Xperia L1 Dual Black",
        ratingRevievs: "18 отзывов", 
        price: {
            oldUan: "5 999 грн", 
            newUan: "4 999 грн"
        }
    }
]


function displayTable(){

    table.innerHTML = `
        <caption>Products</caption>
        <tr>
            <th rowspan="2">Name</th>
            <th rowspan="2">Raving reviews</th>
            <th colspan="2">Price</th>
        </tr>
        <tr>
            <th>Old / Current</th>
            <th>New</th>
        </tr>
    `

    for (var product of products){
        var tr = table.appendChild(document.createElement("tr"))
        for (var prop in product) {
            if (typeof product[prop] === 'object') {
                for (var x in product[prop]) {
                    var td = tr.appendChild(document.createElement("td"))
                    td.innerHTML = `${product[prop][x]}`
                }
            } else {
                var td = tr.appendChild(document.createElement("td"))
                td.innerHTML = `${product[prop]}`
            }
        }
    }
}

function destroyTable(){
    while(table.firstChild) {
        table.removeChild(table.firstChild)
    }    
}

//Choosing an option - ascending or descending
function checkRadio() {
    if (!minToMax.checked && !maxToMin.checked) {
        return "Choose an option!!!"
    } else
    if (minToMax.checked) {
        return "minToMax"
    } else
    if (maxToMin.checked) {
        return "maxToMin"
    }
}

function sortByReviews(arr) {
    function compareReviews(prevProp, nextProp) {
        return prevProp.ratingRevievs.split(" ")[0] - nextProp.ratingRevievs.split(" ")[0];
    }
    //Check which option was chosen
    checkRadio() === "minToMax" ? arr.sort(compareReviews) : 
        checkRadio() === "maxToMin" ? arr.sort(compareReviews).reverse() : 
            alert("Choose an option!!!") 
    //Rebuilding table
    destroyTable()
    displayTable()
}

function sortByPrice(arr) {
    function comparePrice(prevProp, nextProp) {
        //Checking if property is an object(price)
        if (typeof prevProp.price === 'object' && typeof nextProp.price === 'string') {
            return prevProp.price.newUan.slice(0, prevProp.price.newUan.indexOf("грн")).trim().split(" ").join("") - 
                
            nextProp.price.slice(0, nextProp.price.indexOf("грн")).trim().split(" ").join("");
        } else
        if (typeof prevProp.price === 'string' && typeof nextProp.price === 'object') {
            return prevProp.price.slice(0, prevProp.price.indexOf("грн")).trim().split(" ").join("") - 
                nextProp.price.newUan.slice(0, nextProp.price.newUan.indexOf("грн")).trim().split(" ").join("");
        } else 
        if (typeof prevProp.price === 'object' && typeof nextProp.price === 'object') {
            return prevProp.price.newUan.slice(0, prevProp.price.newUan.indexOf("грн")).trim().split(" ").join("") - 
                nextProp.price.newUan.slice(0, nextProp.price.newUan.indexOf("грн")).trim().split(" ").join("");
        } else {
            return prevProp.price.slice(0, prevProp.price.indexOf("грн")).trim().split(" ").join("") - 
                nextProp.price.slice(0, nextProp.price.indexOf("грн")).trim().split(" ").join("");
        }
    }
    //Check which option was chosen
    checkRadio() === "minToMax" ? arr.sort(comparePrice) : 
        checkRadio() === "maxToMin" ? arr.sort(comparePrice).reverse() : 
            alert("Choose an option!!!")
    //Rebuilding table
    destroyTable()
    displayTable()
}

window.onload = () => displayTable()

btnReviews.addEventListener("click", () => sortByReviews(products))
btnPrice.addEventListener("click", () => sortByPrice(products))